
# DS3232 IC
The **DS3232** is a high-accuracy real-time clock (RTC) IC with a built-in crystal oscillator, temperature compensation, alarms, and battery-backed SRAM. It communicates using the **IÂ²C** protocol and allows you to set or read date, time, alarms, and more.

This guide covers:
- The **register map**
- How the **registers behave**
- How to **set values**
- How to work with **IÂ²C register selection**
- Example code with **automatic register increment** behavior

---

## IÂ²C Basics

- **IÂ²C Address (7-bit):** `0x68`
- **8-bit Write Address:** `0xD0` (`0x68 << 1 | 0`)
- **8-bit Read Address:** `0xD1` (`0x68 << 1 | 1`)

---

## How the DS3232 Handles Registers

- All registers are **byte-addressable**
- Registers are selected by sending a **register address byte**
- **Automatic register increment**:
  - After writing a register, the DS3232 **automatically moves to the next one**
  - Useful for writing multiple sequential values like seconds, minutes, hours

---

## Register Map

| Address | Name       | Function                                 | Format |
|------|------------|------------------------------------------|--------|
| 0x00 | Seconds    | Seconds (00â€“59)                          | BCD    |
| 0x01 | Minutes    | Minutes (00â€“59)                          | BCD    |
| 0x02 | Hours      | Hours (00â€“23 or 01â€“12 with AM/PM)        | BCD    |
| 0x03 | Day        | Day of the week (1 = Sunday â€¦ 7 = Sat)   | BCD    |
| 0x04 | Date       | Day of month (01â€“31)                     | BCD    |
| 0x05 | Month      | Month (01â€“12), Bit 7 = Century bit       | BCD    |
| 0x06 | Year       | Year (00â€“99)                             | BCD    |
| 0x07â€“0x0A | Alarm 1 Registers | Flexible alarm (with second) | BCD & Control Bits |
| 0x0Bâ€“0x0D | Alarm 2 Registers | Flexible alarm (without second) | BCD & Control Bits |
| 0x0E | Control    | Enables alarms, square wave, etc.        | Bitwise |
| 0x0F | Status     | Alarm flags, oscillator status           | Bitwise |
| 0x10 | Aging Offset | Frequency calibration                  | Signed |
| 0x11â€“0x12 | Temp MSB/LSB | Internal temperature (in Â°C)      | Integer + 0.25Â°C |
| 0x13â€“0xFF | SRAM   | Battery-backed user RAM                 | Byte   |

---

## Timekeeping Register Details

| Register | Bits | Description |
|----------|------|-------------|
| Seconds (0x00) | 7:0 | BCD-encoded 0â€“59 |
| Minutes (0x01) | 7:0 | BCD-encoded 0â€“59 |
| Hours (0x02)   | 6:0 | 24-hour or 12-hour with AM/PM |
| Day (0x03)     | 2:0 | 1â€“7 (Sunday to Saturday) |
| Date (0x04)    | 5:0 | Day of month (1â€“31) |
| Month (0x05)   | 4:0 | Month (1â€“12), Bit 7 = Century bit |
| Year (0x06)    | 7:0 | Year offset from 2000 (00â€“99) |

> **All time and date values are BCD-encoded!**

---

## Register Selection + Auto-Increment

### ðŸ”¹ To write to a single register:

1. Send START  
2. Send slave address (`0xD0`)  
3. Send register address (e.g., `0x01` for minutes)  
4. Send data (BCD format)  
5. Send STOP

### ðŸ”¹ To write to multiple registers:

1. Set the **starting register address**  
2. Then send **multiple bytes**  
3. DS3232 will auto-increment the pointer

---

## BCD Conversion Helpers (C Example)

```c
uint8_t dec_to_bcd(uint8_t val) {
    return ((val / 10 * 16) + (val % 10));
}

uint8_t bcd_to_dec(uint8_t val) {
    return ((val / 16 * 10) + (val % 16));
}
```

---

## Example: Set Time to 12:34:56 on Thursday, 7 August 2025

### BCD values:

- Seconds: `56` â†’ `0x56`  
- Minutes: `34` â†’ `0x34`  
- Hours: `12` â†’ `0x12`  
- Day of Week: `4` (Thursday) â†’ `0x04`  
- Date: `7` â†’ `0x07`  
- Month: `8` â†’ `0x08`  
- Year: `25` (2025) â†’ `0x25`

### IÂ²C Code (AVR Style Pseudocode):

```c
i2c_start();
i2c_write(0xD0);         // Select DS3232 (write)
i2c_write(0x00);         // Start at register 0x00 (seconds)

i2c_write(dec_to_bcd(56));  // Seconds
i2c_write(dec_to_bcd(34));  // Minutes
i2c_write(dec_to_bcd(12));  // Hours (24h mode)
i2c_write(dec_to_bcd(4));   // Day of week (Thursday)
i2c_write(dec_to_bcd(7));   // Date
i2c_write(dec_to_bcd(8));   // Month
i2c_write(dec_to_bcd(25));  // Year

i2c_stop();              // Done!
```

---

## Reading Time Back

1. Send START  
2. Send `0xD0` (write)  
3. Send register address (`0x00`)  
4. Send REPEATED START  
5. Send `0xD1` (read)  
6. Read 7 bytes: seconds, minutes, hours, day, date, month, year

---

## Summary

| Feature | Detail |
|--------|--------|
| Register access | Byte-addressable |
| Selection | Send register address after slave address |
| Auto increment | Yes |
| Format | BCD for time/date |
| IÂ²C write address | `0xD0` |
| IÂ²C read address | `0xD1` |

---

## Tips

- Always convert decimal to BCD before writing  
- Always set register pointer before reading or writing  
- Use auto-increment for efficient multiple register access
